<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard IVV - Apresenta√ß√£o Executiva</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; background:linear-gradient(135deg,#478DDC 0%,#2c5aa0 100%); color:#333; line-height:1.6; }
    .container { max-width:1400px; margin:0 auto; padding:20px; }
    .nav-bar { background:rgba(255,255,255,0.1); backdrop-filter:blur(10px); border-radius:15px; padding:20px; margin-bottom:30px; text-align:center; }
    .nav-buttons { display:flex; justify-content:center; gap:15px; flex-wrap:wrap; }
    .nav-btn { background:rgba(255,255,255,0.2); color:white; padding:12px 24px; border:none; border-radius:25px; cursor:pointer; font-size:14px; font-weight:600; transition:all .3s ease; text-decoration:none; display:inline-block; }
    .nav-btn:hover { background:rgba(255,255,255,0.3); transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,0,0,0.2); }
    .nav-btn.active { background:#27ae60; box-shadow:0 5px 15px rgba(39,174,96,0.3); }
    .section { display:none; }
    .section.active { display:block; }
    .header { text-align:center; color:white; margin-bottom:40px; padding:30px 0; position:relative; }
    .header-content { display:flex; align-items:center; justify-content:flex-start; gap:30px; padding:0 40px; }
    .logo { height:100px; width:auto; filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.3)) drop-shadow(0 0 8px rgba(255,255,255,0.8)); flex-shrink:0; }
    .header-text { flex-grow:1; text-align:center; }
    .month-ref { position:absolute; top:20px; right:40px; background:rgba(255,255,255,0.2); padding:8px 15px; border-radius:20px; font-weight:bold; font-size:14px; backdrop-filter:blur(10px); }
    .header h1 { font-size:2.5em; margin-bottom:10px; text-shadow:2px 2px 4px rgba(0,0,0,0.3); }
    .header p { font-size:1.2em; opacity:.9; }
    .chart-container { background:white; border-radius:15px; padding:30px; margin-bottom:30px; box-shadow:0 10px 30px rgba(0,0,0,0.2); backdrop-filter:blur(10px); }
    .chart-title { font-size:1.8em; margin-bottom:20px; color:#2c3e50; text-align:center; font-weight:600; }
    .chart-subtitle { font-size:1em; color:#7f8c8d; text-align:center; margin-bottom:30px; }
    .chart-wrapper { position:relative; height:400px; margin-bottom:20px; }
    .chart-wrapper.small { height:300px; }
    .insights { background:#f8f9fa; border-radius:10px; padding:20px; margin-top:20px; border-left:5px solid #3498db; }
    .insights h4 { color:#2c3e50; margin-bottom:10px; }
    .insights ul { list-style-type:none; padding-left:0; }
    .insights li { padding:5px 0; color:#555; }
    .insights li:before { content:"‚ñ∏ "; color:#3498db; font-weight:bold; }
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:30px; margin-bottom:30px; }
    /* ===== RESPONSIVIDADE MOBILE COMPLETA ===== */
    
    /* Tablets e telas m√©dias */
    @media (max-width: 1024px) {
      .container { padding: 15px; }
      .header h1 { font-size: 2.2em; }
      .summary-card { padding: 30px; }
      .metrics-grid { grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
      .chart-container { padding: 25px; }
    }
    
    /* Tablets em retrato e smartphones grandes */
    @media (max-width: 768px) {
      .grid { grid-template-columns: 1fr; }
      .header h1 { font-size: 2em; }
      .chart-container { padding: 20px; }
      .nav-buttons { gap: 10px; }
      .nav-btn { 
        padding: 14px 20px; 
        font-size: 15px; 
        min-height: 48px; /* Touch-friendly */ 
        border-radius: 30px;
      }
      .summary-card { 
        padding: 25px; 
        border-radius: 15px; 
      }
      .summary-title { 
        font-size: 1.8em; 
        margin-bottom: 25px; 
      }
      .metrics-grid { 
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
        gap: 12px; 
      }
      .metric-item { 
        padding: 15px; 
        border-radius: 12px; 
      }
      .metric-value { 
        font-size: 1.4em; 
      }
      .metric-label { 
        font-size: 0.8em; 
      }
      .chart-title { 
        font-size: 1.3em; 
      }
      .chart-subtitle { 
        font-size: 0.9em; 
      }
    }
    
    /* Smartphones */
    @media (max-width: 480px) {
      .container { 
        padding: 10px; 
        margin: 0; 
      }
      .nav-bar { 
        padding: 15px; 
        margin-bottom: 20px; 
        border-radius: 12px; 
      }
      .nav-buttons { 
        flex-direction: column; 
        gap: 8px; 
      }
      .nav-btn { 
        width: 100%; 
        padding: 16px; 
        font-size: 16px; 
        min-height: 52px; /* Ainda mais touch-friendly */
        border-radius: 25px;
        text-align: center;
      }
      .header { 
        padding: 20px; 
        border-radius: 12px; 
      }
      .header h1 { 
        font-size: 1.6em; 
        line-height: 1.2; 
      }
      .logo { 
        height: 70px; 
        margin-right: 10px; 
      }
      .summary-card { 
        padding: 20px; 
        border-radius: 12px; 
        margin-bottom: 20px; 
      }
      .summary-title { 
        font-size: 1.5em; 
        margin-bottom: 20px; 
      }
      .metrics-grid { 
        grid-template-columns: 1fr; 
        gap: 10px; 
      }
      .metric-item { 
        padding: 12px; 
        border-radius: 10px; 
      }
      .metric-value { 
        font-size: 1.2em; 
      }
      .metric-label { 
        font-size: 0.75em; 
      }
      .chart-container { 
        padding: 15px; 
        margin-bottom: 20px; 
        border-radius: 12px; 
      }
      .chart-title { 
        font-size: 1.1em; 
        margin-bottom: 8px; 
      }
      .chart-subtitle { 
        font-size: 0.8em; 
      }
      .chart-wrapper { 
        height: 280px; /* Altura otimizada para mobile */
      }
      .chart-wrapper.small { 
        height: 220px; 
      }
      .insights { 
        padding: 12px; 
        border-radius: 8px; 
      }
      .insights h4 { 
        font-size: 1em; 
        margin-bottom: 8px; 
      }
      .insights ul { 
        font-size: 0.85em; 
      }
      .highlight-box { 
        padding: 12px; 
        border-radius: 8px; 
        margin: 15px 0; 
      }
      .highlight-box h3 { 
        font-size: 1.2em; 
      }
      .region-table th, .region-table td { 
        padding: 6px 8px; 
        font-size: 0.85em; 
        min-width: 60px; /* Reduzir largura m√≠nima em mobile */
      }
      
      .region-table th:first-child,
      .region-table td:first-child {
        min-width: 90px; /* Largura reduzida para regi√£o em mobile */
      }
      
      .table-wrapper {
        border-radius: 6px;
        box-shadow: 0 1px 4px rgba(0,0,0,0.1);
      }
      
      .region-table {
        min-width: 500px; /* Largura m√≠nima reduzida para mobile */
      }
    }
    
    /* Smartphones pequenos */
    @media (max-width: 360px) {
      .container { padding: 8px; }
      .header h1 { font-size: 1.4em; }
      .nav-btn { font-size: 15px; padding: 14px; }
      .summary-title { font-size: 1.3em; }
      .metric-value { font-size: 1.1em; }
      .chart-wrapper { height: 250px; }
      .chart-wrapper.small { height: 200px; }
      .logo { height: 60px; }
    }
    
    /* ===== OTIMIZA√á√ïES PARA APRESENTA√á√ÉO MOBILE ===== */
    @media (max-width: 768px) {
      #presentationContainer .slide {
        padding: 20px 10px;
      }
      
      #presentationContainer .chart-container {
        padding: 15px;
        margin-bottom: 15px;
      }
      
      #presentationContainer .chart-title {
        font-size: 1.2em;
        margin-bottom: 8px;
      }
      
      #presentationContainer .chart-subtitle {
        font-size: 0.85em;
      }
      
      #presentationContainer .chart-wrapper {
        height: 60vh; /* Usa viewport height para mobile */
        max-height: 400px;
      }
      
      #presentationContainer .highlight-box {
        padding: 10px;
        margin: 10px 0;
      }
      
      #presentationContainer .insights {
        padding: 10px;
        font-size: 0.9em;
      }
      
      /* Navega√ß√£o da apresenta√ß√£o otimizada para touch */
      #presentationContainer .slide.active {
        overflow-y: auto; /* Permite scroll se necess√°rio */
        -webkit-overflow-scrolling: touch; /* Smooth scroll no iOS */
      }
    }
    
    /* ===== MELHORIAS TOUCH-FRIENDLY ===== */
    
    /* Aumentar √°rea de toque para todos os bot√µes */
    .nav-btn, button {
      min-height: 44px; /* Padr√£o de acessibilidade Apple/Google */
      min-width: 44px;
    }
    
    /* OCULTAR APRESENTA√á√ÉO EM MOBILE */
    @media (max-width: 768px) {
      #presentationButton {
        display: none !important; /* Oculta completamente o bot√£o em mobile */
      }
    }
    
    /* Melhorar legibilidade em telas pequenas */
    @media (max-width: 768px) {
      body {
        font-size: 16px; /* Evita zoom no iOS */
        line-height: 1.5;
      }
      
      /* Evitar zoom em inputs (se houver) */
      input, select, textarea {
        font-size: 16px;
      }
    }
    
    /* ===== ORIENTA√á√ÉO ===== */
    @media screen and (orientation: landscape) and (max-height: 500px) {
      .header h1 { font-size: 1.3em; }
      .nav-btn { padding: 8px 16px; }
      .chart-wrapper { height: 250px; }
      .summary-card { padding: 15px; }
    }
    .highlight-box { background:linear-gradient(45deg,#27ae60,#2ecc71); color:white; padding:15px; border-radius:10px; text-align:center; margin:20px 0; }
    .highlight-box h3 { font-size:1.5em; margin-bottom:10px; }
    
    /* Estilos para o card de resumo */
    .summary-card { background:linear-gradient(135deg,#ffffff 0%,#f8f9fa 100%); border-radius:20px; padding:40px; margin-bottom:30px; box-shadow:0 15px 35px rgba(0,0,0,0.1); }
    .summary-title { font-size:2.2em; color:#2c3e50; text-align:center; margin-bottom:30px; font-weight:700; }
    .metrics-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:20px; }
    .metric-item { background:white; border-radius:15px; padding:20px; text-align:center; box-shadow:0 8px 25px rgba(0,0,0,0.08); border-left:5px solid #3498db; transition:transform 0.3s ease; position:relative; }
    .metric-item:hover { transform:translateY(-5px); box-shadow:0 12px 30px rgba(0,0,0,0.15); }
    .metric-label { font-size:0.85em; color:#7f8c8d; font-weight:600; margin-bottom:8px; text-transform:uppercase; letter-spacing:0.5px; }
    .metric-value { font-size:1.6em; color:#2c3e50; font-weight:700; margin-bottom:5px; }
    .metric-trend { position:absolute; top:15px; right:15px; font-size:1.2em; }
    .metric-item:nth-child(1) { border-left-color:#e74c3c; }
    .metric-item:nth-child(2) { border-left-color:#f39c12; }
    .metric-item:nth-child(3) { border-left-color:#9b59b6; }
    .metric-item:nth-child(4) { border-left-color:#3498db; }
    .metric-item:nth-child(5) { border-left-color:#27ae60; }
    .metric-item:nth-child(6) { border-left-color:#e67e22; }
    .metric-item:nth-child(7) { border-left-color:#1abc9c; }
    .metric-item:nth-child(8) { border-left-color:#95a5a6; }
    .metric-item:nth-child(9) { border-left-color:#34495e; }
    .metric-item:nth-child(10) { border-left-color:#8e44ad; }
    .metric-item:nth-child(11) { border-left-color:#d35400; }
    /* Estilos para as tabelas regionais */
    .table-wrapper {
      width: 100%;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch; /* Smooth scrolling no iOS */
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-top: 15px;
      position: relative;
    }
    
    /* Indicador visual de scroll horizontal */
    .table-wrapper::-webkit-scrollbar {
      height: 6px;
    }
    
    .table-wrapper::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    
    .table-wrapper::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 3px;
    }
    
    .table-wrapper::-webkit-scrollbar-thumb:hover {
      background: #a1a1a1;
    }
    
    /* Sombra para indicar mais conte√∫do √† direita */
    .table-wrapper::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      bottom: 6px; /* Espa√ßo para scrollbar */
      width: 20px;
      background: linear-gradient(to left, rgba(255,255,255,0.8), transparent);
      pointer-events: none;
      border-radius: 0 8px 8px 0;
    }
    
    .region-table {
      width: 100%;
      min-width: 600px; /* Garante largura m√≠nima para n√£o comprimir */
      border-collapse: collapse;
      margin: 0; /* Remove margin para ficar dentro do wrapper */
      background: white;
    }
    
    .region-table th, .region-table td {
      padding: 8px 12px;
      border: 1px solid #ddd;
      text-align: center;
      white-space: nowrap; /* Evita quebra de linha */
      min-width: 80px; /* Largura m√≠nima das colunas */
    }
    
    .region-table th {
      background-color: #f2f2f2;
      font-weight: 600;
      position: sticky; /* Cabe√ßalho fixo no scroll horizontal */
      top: 0;
      z-index: 10;
    }
    
    .region-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    .region-table tr:hover {
      background-color: #f5f5f5;
    }
    
    /* Primeira coluna (Regi√£o) fixa no scroll horizontal */
    .region-table th:first-child,
    .region-table td:first-child {
      position: sticky;
      left: 0;
      background-color: white !important; /* For√ßa fundo branco sempre */
      z-index: 11;
      box-shadow: 2px 0 4px rgba(0,0,0,0.1);
      min-width: 120px; /* Largura adequada para nomes de regi√£o */
    }
    
    .region-table th:first-child {
      background-color: #f2f2f2 !important; /* For√ßa fundo do cabe√ßalho */
      z-index: 12; /* Maior que as c√©lulas para ficar por cima */
    }
    
    /* For√ßa fundo branco em linhas alternadas */
    .region-table tr:nth-child(even) td:first-child {
      background-color: white !important;
    }
    
    .region-table tr:hover td:first-child {
      background-color: #f5f5f5 !important;
    }

    /* Slide Presentation Styles */
    #presentationContainer {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: linear-gradient(135deg,#478DDC 0%,#2c5aa0 100%);
      z-index: 9999;
      overflow-y: auto;
      padding: 40px;
    }

    #presentationContainer .slide {
      display: none;
      height: 100%;
      /* permitir rolagem interna quando conte√∫do excede a altura */
      overflow-y: auto;
    }

    #presentationContainer .slide.active {
      display: block;
    }

    /* Ajuste para tabelas em modo apresenta√ß√£o */
    #presentationContainer .table-wrapper {
      max-height: 70vh;
      overflow-y: auto;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      border-radius: 6px;
      background: white;
    }
    
    #presentationContainer .region-table {
      max-height: none;
      min-width: 500px;
      font-size: 14px;
      margin: 0;
    }
    
    #presentationContainer .region-table th,
    #presentationContainer .region-table td {
      padding: 6px 10px;
      font-size: 13px;
    }
    
    #presentationContainer .region-table th:first-child,
    #presentationContainer .region-table td:first-child {
      min-width: 100px;
      background-color: white !important; /* For√ßa fundo branco no modo apresenta√ß√£o */
    }
    
    #presentationContainer .region-table th:first-child {
      background-color: #f2f2f2 !important; /* For√ßa fundo do cabe√ßalho na apresenta√ß√£o */
    }
    
    #presentationContainer .region-table tr:nth-child(even) td:first-child {
      background-color: white !important;
    }
    
    #presentationContainer .region-table tr:hover td:first-child {
      background-color: #f5f5f5 !important;
    }

    #presentationControls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 10000;
    }
    #presentationControls button {
      padding: 10px 20px;
      margin: 5px;
      font-size: 16px;
    }
    
    /* Apresenta√ß√£o desabilitada em mobile - elementos ocultos */
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="month-ref">üìÖ M√™s Ref.: Nov/25</div>
    <div class="header-content">
      <img src="https://raw.githubusercontent.com/aag1974/apn-ivv/main/logo.png" alt="Opini√£o Logo" class="logo">
      <div class="header-text">
        <h1>üìä Pesquisa IVV Residencial</h1>
        <p>√çndice de Velocidade de Vendas - An√°lise Executiva</p>
        <small>Relat√≥rio gerado em: 25/12/2025 19:27</small>
      </div>
    </div>
  </div>

  <div class="nav-bar">
    <div class="nav-buttons">
      <button class="nav-btn active" onclick="showSection('resumo')">üìã Nov/25</button>
      <button class="nav-btn" onclick="showSection('ivv')">üìà IVV</button>
      <button class="nav-btn" onclick="showSection('ofertas')">üè¢ Ofertas</button>
      <button class="nav-btn" onclick="showSection('vendas')">üí∞ Vendas</button>
      <button class="nav-btn" onclick="showSection('lancamentos')">üöÄ Lan√ßamentos</button>
      <button class="nav-btn" onclick="showSection('precos')">üí≤ Pre√ßos</button>
      <button class="nav-btn" onclick="showSection('vgv-ofertas')">üìä VGV Ofertas</button>
      <button class="nav-btn" onclick="showSection('vgv-vendas')">üìä VGV Vendas</button>
      <!-- Novas se√ß√µes: VGL (Valor Geral de Lan√ßamentos) e Distratos -->
      <button class="nav-btn" onclick="showSection('vgl')">üìà VGL</button>
      <button class="nav-btn" onclick="showSection('distratos')">‚ùå Distratos</button>
    </div>
    <!-- Presentation Button -->
    <div style="text-align:center; margin-top:20px;">
      <button id="presentationButton" class="nav-btn">Iniciar Apresenta√ß√£o</button>
    </div>
  </div>

  <!-- Nova se√ß√£o de resumo -->
  <div id="resumo" class="section active">
    <div class="summary-card">
      <div class="summary-title">üìä Resumo Executivo - Nov/25</div>
      <div class="metrics-grid">
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">IVV</div>
          <div class="metric-value">7,9%</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">Unidades Ofertadas</div>
          <div class="metric-value">5.238</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">Unidades Vendidas</div>
          <div class="metric-value">416</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">Unidades Lan√ßadas</div>
          <div class="metric-value" id="lancamentos-card">180 (2)</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üü¢</div>
          <div class="metric-label">Pre√ßo de Oferta</div>
          <div class="metric-value">R$ 15.611</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üü¢</div>
          <div class="metric-label">Pre√ßo de Venda</div>
          <div class="metric-value">R$ 12.464</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">Oferta em m¬≤</div>
          <div class="metric-value">498.175 m¬≤</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">Venda em m¬≤</div>
          <div class="metric-value">30.151 m¬≤</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">VGL</div>
          <div class="metric-value">R$ 170M</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">VGV Ofertas</div>
          <div class="metric-value">R$ 7.777M</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">VGV Vendas</div>
          <div class="metric-value">R$ 376M</div>
        </div>
        <div class="metric-item">
          <div class="metric-trend">üî¥</div>
          <div class="metric-label">Distratos</div>
          <div class="metric-value">23</div>
        </div>
      </div>
    </div>
  </div>

  <div id="ivv" class="section">
    <div class="chart-container">
      <div class="chart-title">IVV Mensal - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Varia√ß√£o mensal do √çndice de Velocidade de Vendas (%)</div>
      <div class="chart-wrapper"><canvas id="ivvMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -12,4%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: 7,6%</li>
          <li>Pico: 10,4% (Jun)</li>          <li>M√©dia anual: 7,6%</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">IVV Trimestral</div>
        <div class="chart-subtitle">Performance por trimestre (%)</div>
        <div class="chart-wrapper small"><canvas id="ivvQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 3T - 8,2%</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">IVV Anual</div>
        <div class="chart-subtitle">Performance anual consolidada (%)</div>
        <div class="chart-wrapper small"><canvas id="ivvYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 7,6% (+9,6%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  
<div class="chart-container">
  <div class="chart-title">IVV por Regi√£o (%)</div>
  <div class="chart-subtitle">Distribui√ß√£o por n√∫mero de quartos</div>
  <div class="table-wrapper">
    <table class="region-table">
      <tr><th>Regi√£o</th><th>1 qto</th><th>2 qtos</th><th>3 qtos</th><th>4+ qtos</th><th>IVV Total</th></tr>
      <tr><td>Recanto das Emas</td><td>-</td><td>32,3%</td><td>-</td><td>-</td><td>32,3%</td></tr>
      <tr><td>Planaltina</td><td>-</td><td>30,4%</td><td>-</td><td>-</td><td>30,4%</td></tr>
      <tr><td>Sobradinho</td><td>-</td><td>42,2%</td><td>18,9%</td><td>31,6%</td><td>27,0%</td></tr>
      <tr><td>Santa Maria</td><td>-</td><td>14,8%</td><td>-</td><td>-</td><td>14,8%</td></tr>
      <tr><td>Ceil√¢ndia</td><td>-</td><td>11,0%</td><td>75,0%</td><td>-</td><td>13,7%</td></tr>
      <tr><td>Park Sul</td><td>16,5%</td><td>24,0%</td><td>1,7%</td><td>6,4%</td><td>12,7%</td></tr>
      <tr><td>Sobradinho II</td><td>-</td><td>3,4%</td><td>11,7%</td><td>-</td><td>9,8%</td></tr>
      <tr><td>Noroeste</td><td>5,6%</td><td>18,8%</td><td>3,9%</td><td>3,0%</td><td>9,3%</td></tr>
      <tr><td>Guar√°</td><td>-</td><td>12,5%</td><td>7,3%</td><td>9,8%</td><td>8,3%</td></tr>
      <tr><td>Lago Norte</td><td>-</td><td>-</td><td>10,0%</td><td>6,1%</td><td>7,9%</td></tr>
      <tr><td>Gama</td><td>-</td><td>7,3%</td><td>6,7%</td><td>-</td><td>6,8%</td></tr>
      <tr><td>Samambaia</td><td>2,5%</td><td>12,7%</td><td>4,5%</td><td>-</td><td>6,1%</td></tr>
      <tr><td>Taguatinga</td><td>100,0%</td><td>3,0%</td><td>3,6%</td><td>-</td><td>3,1%</td></tr>
      <tr><td>√Åguas Claras</td><td>2,2%</td><td>3,6%</td><td>2,0%</td><td>0,5%</td><td>2,3%</td></tr>
      <tr><td>Jardim Bot√¢nico</td><td>-</td><td>-</td><td>10,0%</td><td>1,2%</td><td>2,1%</td></tr>
      <tr><td>Sudoeste</td><td>-</td><td>-</td><td>1,4%</td><td>2,7%</td><td>1,8%</td></tr>
      <tr><td>Asa Sul</td><td>-</td><td>2,2%</td><td>1,8%</td><td>-</td><td>1,4%</td></tr>
      <tr><td>Asa Norte</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
      <tr><td>IVV Total</td><td>7,3%</td><td>13,2%</td><td>4,9%</td><td>3,0%</td><td>7,9%</td></tr>
    </table>
  </div>
</div>
</div>

  <div id="ofertas" class="section">
    <div class="chart-container">
      <div class="chart-title">Ofertas Mensais - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Volume mensal de ofertas (Unidades)</div>
      <div class="chart-wrapper"><canvas id="ofertasMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -4,6%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -8,8%</li>
          <li>Pico: 5.509 (Jan)</li>          <li>M√©dia anual: 5.086</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Ofertas Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="ofertasQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 1T - 5.277</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Ofertas Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="ofertasYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 5.086 (-20,1%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
    <!-- Oferta em m¬≤ -->
    <div class="chart-container">
      <div class="chart-title">Oferta em m¬≤ Mensais - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Volume mensal de oferta (m¬≤)</div>
      <div class="chart-wrapper"><canvas id="ofertaM2MonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -5,7%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -3,0%</li>
          <li>Pico: 530.844 (Jun)</li>          <li>M√©dia anual: 490.022</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Oferta em m¬≤ Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (m¬≤)</div>
        <div class="chart-wrapper small"><canvas id="ofertaM2QuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 2T - 510.068 m¬≤</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Oferta em m¬≤ Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (m¬≤)</div>
        <div class="chart-wrapper small"><canvas id="ofertaM2YearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 490.022 (-6,6%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  
<div class="chart-container">
  <div class="chart-title">Ofertas por Regi√£o</div>
  <div class="chart-subtitle">Distribui√ß√£o por n√∫mero de quartos</div>
  <div class="table-wrapper">
    <table class="region-table">
      <tr><th>Regi√£o</th><th>1 qto</th><th>2 qtos</th><th>3 qtos</th><th>4+ qtos</th><th>Pre√ßo M√©dio</th></tr>
      <tr><td>Pre√ßo M√©dio</td><td>590</td><td>1.965</td><td>1.781</td><td>902</td><td>5.238</td></tr>
      <tr><td>√Åguas Claras</td><td>90</td><td>474</td><td>744</td><td>216</td><td>1.524</td></tr>
      <tr><td>Noroeste</td><td>177</td><td>398</td><td>309</td><td>230</td><td>1.114</td></tr>
      <tr><td>Samambaia</td><td>80</td><td>110</td><td>110</td><td>46</td><td>346</td></tr>
      <tr><td>Park Sul</td><td>170</td><td>25</td><td>58</td><td>47</td><td>300</td></tr>
      <tr><td>Ceil√¢ndia</td><td>0</td><td>272</td><td>12</td><td>0</td><td>284</td></tr>
      <tr><td>Sudoeste</td><td>0</td><td>35</td><td>69</td><td>113</td><td>217</td></tr>
      <tr><td>Asa Sul</td><td>59</td><td>93</td><td>56</td><td>0</td><td>208</td></tr>
      <tr><td>Sobradinho</td><td>0</td><td>45</td><td>95</td><td>19</td><td>159</td></tr>
      <tr><td>Planaltina</td><td>0</td><td>158</td><td>0</td><td>0</td><td>158</td></tr>
      <tr><td>Guar√°</td><td>0</td><td>8</td><td>96</td><td>41</td><td>145</td></tr>
      <tr><td>Santa Maria</td><td>0</td><td>135</td><td>0</td><td>0</td><td>135</td></tr>
      <tr><td>Sobradinho II</td><td>0</td><td>29</td><td>103</td><td>0</td><td>132</td></tr>
      <tr><td>Taguatinga</td><td>1</td><td>66</td><td>28</td><td>36</td><td>131</td></tr>
      <tr><td>Jardim Bot√¢nico</td><td>0</td><td>0</td><td>10</td><td>85</td><td>95</td></tr>
      <tr><td>Asa Norte</td><td>10</td><td>0</td><td>46</td><td>36</td><td>92</td></tr>
      <tr><td>Gama</td><td>3</td><td>55</td><td>15</td><td>0</td><td>73</td></tr>
      <tr><td>Lago Norte</td><td>0</td><td>0</td><td>30</td><td>33</td><td>63</td></tr>
      <tr><td>Recanto das Emas</td><td>0</td><td>62</td><td>0</td><td>0</td><td>62</td></tr>
    </table>
  </div>
</div>
</div>

  <div id="vendas" class="section">
    <div class="chart-container">
      <div class="chart-title">Vendas Mensais - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Volume mensal de vendas (Unidades)</div>
      <div class="chart-wrapper"><canvas id="vendasMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -16,5%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -1,9%</li>
          <li>Pico: 542 (Jun)</li>          <li>M√©dia anual: 386</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Vendas Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="vendasQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 3T - 1.179</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Vendas Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="vendasYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 4.250 (-19,0%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>

    <!-- Vendas em m¬≤ -->
    <div class="chart-container">
      <div class="chart-title">Vendas em m¬≤ Mensais - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Volume mensal de vendas (m¬≤)</div>
      <div class="chart-wrapper"><canvas id="vendaM2MonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -31,6%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -31,1%</li>
          <li>Pico: 44.089 (Out)</li>          <li>M√©dia anual: 30.452</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Vendas em m¬≤ Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (m¬≤)</div>
        <div class="chart-wrapper small"><canvas id="vendaM2QuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 2T - 92.298 m¬≤</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Vendas em m¬≤ Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (m¬≤)</div>
        <div class="chart-wrapper small"><canvas id="vendaM2YearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 334.972 (-10,3%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  
<div class="chart-container">
  <div class="chart-title">Vendas por Regi√£o</div>
  <div class="chart-subtitle">Distribui√ß√£o por n√∫mero de quartos</div>
  <div class="table-wrapper">
    <table class="region-table">
      <tr><th>Regi√£o</th><th>1 qto</th><th>2 qtos</th><th>3 qtos</th><th>4+ qtos</th><th>Pre√ßo M√©dio</th></tr>
      <tr><td>Pre√ßo M√©dio</td><td>43</td><td>259</td><td>87</td><td>27</td><td>416</td></tr>
      <tr><td>Noroeste</td><td>10</td><td>75</td><td>12</td><td>7</td><td>104</td></tr>
      <tr><td>Planaltina</td><td>0</td><td>48</td><td>0</td><td>0</td><td>48</td></tr>
      <tr><td>Sobradinho</td><td>0</td><td>19</td><td>18</td><td>6</td><td>43</td></tr>
      <tr><td>Ceil√¢ndia</td><td>0</td><td>30</td><td>9</td><td>0</td><td>39</td></tr>
      <tr><td>Park Sul</td><td>28</td><td>6</td><td>1</td><td>3</td><td>38</td></tr>
      <tr><td>√Åguas Claras</td><td>2</td><td>17</td><td>15</td><td>1</td><td>35</td></tr>
      <tr><td>Samambaia</td><td>2</td><td>14</td><td>5</td><td>0</td><td>21</td></tr>
      <tr><td>Recanto das Emas</td><td>0</td><td>20</td><td>0</td><td>0</td><td>20</td></tr>
      <tr><td>Santa Maria</td><td>0</td><td>20</td><td>0</td><td>0</td><td>20</td></tr>
      <tr><td>Sobradinho II</td><td>0</td><td>1</td><td>12</td><td>0</td><td>13</td></tr>
      <tr><td>Guar√°</td><td>0</td><td>1</td><td>7</td><td>4</td><td>12</td></tr>
      <tr><td>Gama</td><td>0</td><td>4</td><td>1</td><td>0</td><td>5</td></tr>
      <tr><td>Lago Norte</td><td>0</td><td>0</td><td>3</td><td>2</td><td>5</td></tr>
      <tr><td>Sudoeste</td><td>0</td><td>0</td><td>1</td><td>3</td><td>4</td></tr>
      <tr><td>Taguatinga</td><td>1</td><td>2</td><td>1</td><td>0</td><td>4</td></tr>
      <tr><td>Asa Sul</td><td>0</td><td>2</td><td>1</td><td>0</td><td>3</td></tr>
      <tr><td>Jardim Bot√¢nico</td><td>0</td><td>0</td><td>1</td><td>1</td><td>2</td></tr>
      <tr><td>Asa Norte</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
    </table>
  </div>
</div>
</div>

  <div id="lancamentos" class="section">
    <!-- Gr√°ficos de empreendimentos (projetos) -->
    <div class="chart-container">
      <div class="chart-title">Empreendimentos Lan√ßados Mensais - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">N√∫mero de empreendimentos lan√ßados por m√™s</div>
      <div class="chart-wrapper"><canvas id="lancProjMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques (Empreendimentos):</h4>
        <ul>
          <li>Varia√ß√£o MoM (empreendimentos): Nov/2025 - Out/2025: -46,9%</li>
          <li>Varia√ß√£o YoY (empreendimentos): Nov/2025 - Nov/2024: -27,7%</li>
          <li>Pico: 5 empreendimentos</li>
          <li>M√©dia anual: 2 empreendimentos</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Empreendimentos Lan√ßados Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (Empreendimentos)</div>
        <div class="chart-wrapper small"><canvas id="lancProjQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre (projetos): 3T - 8</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Empreendimentos Lan√ßados Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (Empreendimentos)</div>
        <div class="chart-wrapper small"><canvas id="lancProjYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 19 (-26,1%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>

    <!-- Gr√°ficos de unidades -->
    <div class="chart-container">
      <div class="chart-title">Lan√ßamentos Mensais (Unidades) - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Volume mensal de lan√ßamentos (Unidades)</div>
      <div class="chart-wrapper"><canvas id="lancMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques (Unidades):</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -46,9%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -27,7%</li>
          <li>Pico: 456 (Jun)</li>
          <li>M√©dia anual: 193</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Lan√ßamentos Trimestrais (Unidades)</div>
        <div class="chart-subtitle">Performance por trimestre (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="lancQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 2T - 607</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Lan√ßamentos Anuais (Unidades)</div>
        <div class="chart-subtitle">Performance anual consolidada (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="lancYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 1.740 (-26,1%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  </div>

  <div id="precos" class="section">
    <div class="chart-container">
      <div class="chart-title">Pre√ßos de Oferta - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Valor m√©dio ponderado mensal (R$)</div>
      <div class="chart-wrapper"><canvas id="precosOfertaMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: 1,8%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: 11,6%</li>
          <li>Pico: R$ 15.725 (Set)</li>          <li>M√©dia anual: R$ 14.928</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Pre√ßos de Oferta Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (R$)</div>
        <div class="chart-wrapper small"><canvas id="precosOfertaQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 3T - R$ 15.495,17</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Pre√ßos de Oferta Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (R$)</div>
        <div class="chart-wrapper small"><canvas id="precosOfertaYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: R$ 14.929,81 (+12,8%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>

    <div class="chart-container">
      <div class="chart-title">Pre√ßos de Venda - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Valor m√©dio ponderado mensal (R$)</div>
      <div class="chart-wrapper"><canvas id="precosVendaMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: 2,6%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -10,1%</li>
          <li>Pico: R$ 13.191 (Abr)</li>          <li>M√©dia anual: R$ 12.296</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Pre√ßos de Venda Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (R$)</div>
        <div class="chart-wrapper small"><canvas id="precosVendaQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 2T - R$ 12.814,56</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Pre√ßos de Venda Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (R$)</div>
        <div class="chart-wrapper small"><canvas id="precosVendaYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: R$ 12.375,25 (+14,9%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  
<div class="chart-container">
  <div class="chart-title">Pre√ßos de Oferta por Regi√£o (R$)</div>
  <div class="chart-subtitle">Distribui√ß√£o por n√∫mero de quartos</div>
  <div class="table-wrapper">
    <table class="region-table">
      <tr><th>Regi√£o</th><th>1 qto</th><th>2 qtos</th><th>3 qtos</th><th>4+ qtos</th><th>Pre√ßo M√©dio</th></tr>
      <tr><td>Sudoeste</td><td>-</td><td>27.340,71</td><td>24.870,42</td><td>26.262,14</td><td>26.020,02</td></tr>
      <tr><td>Asa Sul</td><td>23.532,94</td><td>17.386,36</td><td>30.264,03</td><td>-</td><td>24.233,46</td></tr>
      <tr><td>Asa Norte</td><td>24.736,00</td><td>-</td><td>24.368,05</td><td>19.128,90</td><td>21.428,54</td></tr>
      <tr><td>Jardim Bot√¢nico</td><td>-</td><td>-</td><td>16.438,86</td><td>19.172,94</td><td>18.955,63</td></tr>
      <tr><td>Noroeste</td><td>18.436,84</td><td>18.206,01</td><td>18.352,52</td><td>19.231,07</td><td>18.633,19</td></tr>
      <tr><td>Lago Norte</td><td>-</td><td>-</td><td>18.184,30</td><td>14.842,14</td><td>15.998,20</td></tr>
      <tr><td>Park Sul</td><td>15.908,58</td><td>16.159,65</td><td>15.686,06</td><td>15.406,35</td><td>15.683,46</td></tr>
      <tr><td>Pre√ßo M√©dio</td><td>17.016,28</td><td>12.577,92</td><td>15.240,17</td><td>17.992,25</td><td>15.611,48</td></tr>
      <tr><td>Guar√°</td><td>-</td><td>15.107,43</td><td>14.111,72</td><td>12.525,01</td><td>13.569,08</td></tr>
      <tr><td>√Åguas Claras</td><td>14.585,45</td><td>12.320,73</td><td>11.783,84</td><td>12.785,73</td><td>12.209,53</td></tr>
      <tr><td>Sobradinho II</td><td>-</td><td>9.860,00</td><td>9.664,00</td><td>-</td><td>9.700,85</td></tr>
      <tr><td>Taguatinga</td><td>5.500,00</td><td>9.335,01</td><td>9.194,36</td><td>8.800,00</td><td>9.069,61</td></tr>
      <tr><td>Sobradinho</td><td>-</td><td>8.860,14</td><td>8.890,01</td><td>8.900,00</td><td>8.885,39</td></tr>
      <tr><td>Samambaia</td><td>7.947,66</td><td>7.493,31</td><td>8.963,63</td><td>10.438,45</td><td>8.859,80</td></tr>
      <tr><td>Gama</td><td>7.106,25</td><td>6.777,94</td><td>6.500,00</td><td>-</td><td>6.712,85</td></tr>
      <tr><td>Santa Maria</td><td>-</td><td>6.650,00</td><td>-</td><td>-</td><td>6.650,00</td></tr>
      <tr><td>Ceil√¢ndia</td><td>-</td><td>6.422,40</td><td>6.500,00</td><td>-</td><td>6.427,65</td></tr>
      <tr><td>Planaltina</td><td>-</td><td>5.698,00</td><td>-</td><td>-</td><td>5.698,00</td></tr>
      <tr><td>Recanto das Emas</td><td>-</td><td>5.166,77</td><td>-</td><td>-</td><td>5.166,77</td></tr>
    </table>
  </div>
</div><div class="chart-container">
  <div class="chart-title">Pre√ßos de Venda por Regi√£o (R$)</div>
  <div class="chart-subtitle">Distribui√ß√£o por n√∫mero de quartos</div>
  <div class="table-wrapper">
    <table class="region-table">
      <tr><th>Regi√£o</th><th>1 qto</th><th>2 qtos</th><th>3 qtos</th><th>4+ qtos</th><th>Pre√ßo M√©dio</th></tr>
      <tr><td>Sudoeste</td><td>-</td><td>-</td><td>23.010,39</td><td>25.728,88</td><td>25.311,32</td></tr>
      <tr><td>Asa Sul</td><td>-</td><td>13.820,68</td><td>28.466,43</td><td>-</td><td>20.843,65</td></tr>
      <tr><td>Jardim Bot√¢nico</td><td>-</td><td>-</td><td>18.340,56</td><td>20.213,31</td><td>19.525,66</td></tr>
      <tr><td>Noroeste</td><td>15.701,33</td><td>17.958,08</td><td>18.682,74</td><td>16.242,74</td><td>17.718,60</td></tr>
      <tr><td>Park Sul</td><td>14.766,68</td><td>15.145,06</td><td>16.783,99</td><td>12.560,42</td><td>14.216,58</td></tr>
      <tr><td>Lago Norte</td><td>-</td><td>-</td><td>15.589,68</td><td>11.172,75</td><td>12.992,43</td></tr>
      <tr><td>Pre√ßo M√©dio</td><td>14.190,98</td><td>11.449,35</td><td>12.435,59</td><td>14.855,93</td><td>12.463,88</td></tr>
      <tr><td>Guar√°</td><td>-</td><td>16.223,00</td><td>13.326,54</td><td>10.854,25</td><td>12.419,07</td></tr>
      <tr><td>√Åguas Claras</td><td>11.518,10</td><td>10.945,32</td><td>10.823,16</td><td>10.707,51</td><td>10.887,42</td></tr>
      <tr><td>Sobradinho</td><td>-</td><td>8.805,95</td><td>8.900,00</td><td>8.900,00</td><td>8.870,46</td></tr>
      <tr><td>Sobradinho II</td><td>-</td><td>9.225,00</td><td>8.750,00</td><td>-</td><td>8.780,46</td></tr>
      <tr><td>Taguatinga</td><td>5.500,00</td><td>8.335,00</td><td>9.270,00</td><td>-</td><td>7.978,70</td></tr>
      <tr><td>Samambaia</td><td>6.048,00</td><td>7.118,35</td><td>7.267,69</td><td>-</td><td>7.108,74</td></tr>
      <tr><td>Ceil√¢ndia</td><td>-</td><td>6.466,27</td><td>6.500,00</td><td>-</td><td>6.477,40</td></tr>
      <tr><td>Recanto das Emas</td><td>-</td><td>5.800,00</td><td>-</td><td>-</td><td>5.800,00</td></tr>
      <tr><td>Santa Maria</td><td>-</td><td>5.745,00</td><td>-</td><td>-</td><td>5.745,00</td></tr>
      <tr><td>Planaltina</td><td>-</td><td>5.620,00</td><td>-</td><td>-</td><td>5.620,00</td></tr>
      <tr><td>Gama</td><td>-</td><td>5.418,90</td><td>5.585,23</td><td>-</td><td>5.461,94</td></tr>
      <tr><td>Asa Norte</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
    </table>
  </div>
</div>
</div>

  <div id="vgv-ofertas" class="section">
    <div class="chart-container">
      <div class="chart-title">VGV Ofertas Mensal - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Valor Geral de Vendas sobre Ofertas mensal (R$ M)</div>
      <div class="chart-wrapper"><canvas id="vgvOfertasMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -4,0%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: 8,2%</li>
          <li>Pico (R$ M): R$ 8.101 (Out)</li>          <li>M√©dia anual (R$ M): R$ 7.316</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">VGV Ofertas Trimestral</div>
        <div class="chart-subtitle">Performance por trimestre (R$ M)</div>
        <div class="chart-wrapper small"><canvas id="vgvOfertasQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 2T - R$ 7.536M</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">VGV Ofertas Anual</div>
        <div class="chart-subtitle">Performance anual consolidada (R$ M)</div>
        <div class="chart-wrapper small"><canvas id="vgvOfertasYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: R$ 7.316M (+5,3%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  </div>

  <div id="vgv-vendas" class="section">
    <div class="chart-container">
      <div class="chart-title">VGV Vendas Mensal - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Valor Geral de Vendas sobre Vendas mensal (R$ M)</div>
      <div class="chart-wrapper"><canvas id="vgvVendasMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -29,8%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -38,0%</li>
          <li>Pico (R$ M): R$ 535 (Out)</li>          <li>M√©dia anual (R$ M): R$ 377</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">VGV Vendas Trimestral</div>
        <div class="chart-subtitle">Performance por trimestre (R$ M)</div>
        <div class="chart-wrapper small"><canvas id="vgvVendasQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 2T - R$ 1.183M</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">VGV Vendas Anual</div>
        <div class="chart-subtitle">Performance anual consolidada (R$ M)</div>
        <div class="chart-wrapper small"><canvas id="vgvVendasYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: R$ 4.145M (+3,1%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Se√ß√£o VGL (Valor Geral de Lan√ßamentos) -->
  <div id="vgl" class="section">
    <div class="chart-container">
      <div class="chart-title">VGL Mensal - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Valor geral de lan√ßamentos mensal (R$ M)</div>
      <div class="chart-wrapper"><canvas id="vglMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -33,0%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -76,8%</li>
          <li>Pico (R$ M): R$ 1.200 (Set)</li>          <li>M√©dia anual (R$ M): R$ 330</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">VGL Trimestral</div>
        <div class="chart-subtitle">Performance por trimestre (R$ M)</div>
        <div class="chart-wrapper small"><canvas id="vglQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 3T - R$ 1.380M</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">VGL Anual</div>
        <div class="chart-subtitle">Performance anual consolidada (R$ M)</div>
        <div class="chart-wrapper small"><canvas id="vglYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: R$ 2.974M (+18,0%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Se√ß√£o Distratos -->
  <div id="distratos" class="section">
    <div class="chart-container">
      <div class="chart-title">Distratos Mensais - Evolu√ß√£o 2021-2025</div>
      <div class="chart-subtitle">Volume mensal de distratos (Unidades)</div>
      <div class="chart-wrapper"><canvas id="distratosMonthlyChart"></canvas></div>
      <div class="insights">
        <h4>üí° Destaques:</h4>
        <ul>
          <li>Varia√ß√£o MoM: Nov/2025 - Out/2025: -23,3%</li>
          <li>Varia√ß√£o YoY: Nov/2025 - Nov/2024: -67,1%</li>
          <li>Pico: 229 (Mar)</li>          <li>M√©dia anual: 60</li>
        </ul>
      </div>
    </div>
    <div class="grid">
      <div class="chart-container">
        <div class="chart-title">Distratos Trimestrais</div>
        <div class="chart-subtitle">Performance por trimestre (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="distratosQuarterlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>Melhor trimestre: 1T - 319</h3>
          <p>Destaque trimestral (melhor performance)</p>
          <p class="observation"><em>* Trimestre incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
      <div class="chart-container">
        <div class="chart-title">Distratos Anuais</div>
        <div class="chart-subtitle">Performance anual consolidada (Unidades)</div>
        <div class="chart-wrapper small"><canvas id="distratosYearlyChart"></canvas></div>
        <div class="highlight-box">
          <h3>2025 *: 657 (+41,0%)</h3>
          <p>Performance anual</p>
          <p class="observation"><em>* Ano incompleto (dados at√© Nov/2025)</em></p>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
/* ===== LOCALE E FORMATADORES (OBRIGAT√ìRIO) ===== */
Chart.defaults.locale = 'pt-BR';

function fmtIntBR(value) {
  return value.toLocaleString('pt-BR', {
    maximumFractionDigits: 0
  });
}

function fmtFloatBR(value, decimals = 1) {
  return value.toLocaleString('pt-BR', {
    minimumFractionDigits: decimals,
    maximumFractionDigits: decimals
  });
}

function fmtPercentBR(value, decimals = 1) {
  return fmtFloatBR(value, decimals) + '%';
}

function fmtCurrencyBR(value, decimals = 2) {
  return 'R$ ' + value.toLocaleString('pt-BR', {
    minimumFractionDigits: decimals,
    maximumFractionDigits: decimals
  });
}

/* ===== NAVEGA√á√ÉO ===== */
function showSection(sectionId) {
  const sections = document.querySelectorAll('.section');
  sections.forEach(section => section.classList.remove('active'));

  const target = document.getElementById(sectionId);
  if (target) target.classList.add('active');

  const buttons = document.querySelectorAll('.nav-btn');
  buttons.forEach(btn => btn.classList.remove('active'));

  if (window.event && window.event.target) {
    window.event.target.classList.add('active');
  }
}
// ---------- Datasets (injetados pelo Python)
  const ivvMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [8.6, 10.5, 10.9, 8.5, 8.1, 9.0, 7.7, 7.5, 8.8, 7.6, 6.5, 8.4], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [5.2, 9.0, 10.1, 8.3, 8.5, 7.2, 7.6, 10.4, 7.0, 8.4, 7.4, 7.9], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [5.7, 5.6, 7.4, 7.4, 7.9, 7.3, 5.4, 6.9, 5.6, 4.9, 5.1, 5.4], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [3.8, 4.2, 5.8, 6.3, 12.7, 7.2, 7.0, 7.6, 8.7, 6.1, 7.4, 6.4], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [5.9, 6.2, 6.6, 5.6, 7.3, 10.4, 7.3, 8.2, 9.0, 9.1, 7.9, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const ivvQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [10.0, 8.5, 8.0, 7.5], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [8.1, 8.0, 8.3, 7.9], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [6.2, 7.5, 6.0, 5.1], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [4.6, 8.7, 7.8, 6.6], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [6.2, 7.8, 8.2, 8.5], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const ivvYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [8.5, 8.1, 6.2, 6.9, 7.6], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const ivvYearlyVar = ["-", "-5,1%", "-23,1%", "+11,5%", "+9,6%"];
  const ofertasMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [3319.0, 3782.0, 4319.0, 4047.0, 4690.0, 4492.0, 4268.0, 4263.0, 4582.0, 4496.0, 4762.0, 5074.0], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [4693.0, 5174.0, 4761.0, 4718.0, 5026.0, 4752.0, 4322.0, 4512.0, 4273.0, 4803.0, 5028.0, 4695.0], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [4726.0, 4615.0, 4425.0, 4539.0, 5394.0, 5599.0, 5425.0, 5704.0, 6473.0, 6818.0, 6533.0, 7121.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [7533.0, 7285.0, 7014.0, 6757.0, 6908.0, 6191.0, 5866.0, 5943.0, 5784.0, 5745.0, 5746.0, 5623.0], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [5509.0, 5167.0, 5155.0, 4964.0, 4846.0, 5194.0, 4764.0, 4417.0, 5206.0, 5491.0, 5238.0, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const ofertasQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [3807.0, 4410.0, 4371.0, 4777.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [4876.0, 4832.0, 4369.0, 4842.0], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [4589.0, 5177.0, 5867.0, 6824.0], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [7277.0, 6619.0, 5864.0, 5705.0], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [5277.0, 5001.0, 4796.0, 5365.0], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const ofertasYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [4341.0, 4730.0, 5614.0, 6366.0, 5086.0], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const ofertasYearlyVar = ["-", "+9,0%", "+18,7%", "+13,4%", "-20,1%"];
  const vendasMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [285.0, 397.0, 472.0, 343.0, 378.0, 404.0, 327.0, 320.0, 405.0, 343.0, 309.0, 427.0], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [244.0, 468.0, 479.0, 392.0, 425.0, 343.0, 327.0, 468.0, 297.0, 404.0, 371.0, 372.0], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [271.0, 257.0, 327.0, 334.0, 424.0, 408.0, 291.0, 396.0, 365.0, 337.0, 334.0, 381.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [288.0, 303.0, 410.0, 423.0, 879.0, 445.0, 409.0, 449.0, 505.0, 351.0, 424.0, 360.0], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [324.0, 320.0, 340.0, 277.0, 354.0, 542.0, 350.0, 363.0, 466.0, 498.0, 416.0, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const vendasQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [1154.0, 1125.0, 1052.0, 1079.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [1191.0, 1160.0, 1092.0, 1147.0], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [855.0, 1166.0, 1052.0, 1052.0], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [1001.0, 1747.0, 1363.0, 1135.0], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [984.0, 1173.0, 1179.0, 914.0], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const vendasYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [4410.0, 4590.0, 4125.0, 5246.0, 4250.0], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const vendasYearlyVar = ["-", "+4,1%", "-10,1%", "+27,2%", "-19,0%"];
  const ofertaM2MonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [328584.0, 348984.0, 365049.0, 332963.0, 395864.0, 391709.0, 364548.0, 384584.0, 417360.0, 435837.0, 482553.0, 488966.0], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [450299.0, 490458.0, 462974.0, 478250.0, 488157.0, 464450.0, 436719.0, 450954.0, 435009.0, 447730.0, 450044.0, 412271.0], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [421845.0, 413126.0, 401872.0, 411145.0, 479159.0, 479267.0, 471729.0, 499935.0, 533566.0, 569440.0, 546701.0, 574454.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [591100.0, 571358.0, 557375.0, 545977.0, 554341.0, 515059.0, 490734.0, 494771.0, 487517.0, 482654.0, 513551.0, 491979.0], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [493384.0, 468083.0, 466911.0, 505165.0, 494195.0, 530844.0, 491861.0, 416677.0, 496544.0, 528402.0, 498175.0, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const ofertaM2QuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [347539.0, 373512.0, 388831.0, 469119.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [467910.0, 476952.0, 440894.0, 436682.0], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [412281.0, 456524.0, 501743.0, 563532.0], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [573278.0, 538459.0, 491007.0, 496061.0], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [476126.0, 510068.0, 468361.0, 513288.0], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const ofertaM2YearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [394750.0, 455610.0, 483520.0, 524701.0, 490022.0], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const ofertaM2YearlyVar = ["-", "+15,4%", "+6,1%", "+8,5%", "-6,6%"];
  const vendaM2MonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [22151.0, 31038.0, 36324.0, 30346.0, 29931.0, 34113.0, 25285.0, 27914.0, 36619.0, 28549.0, 24141.0, 36319.0], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [17917.0, 33278.0, 38601.0, 30923.0, 31381.0, 26366.0, 21857.0, 35833.0, 23644.0, 27466.0, 27350.0, 26727.0], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [19187.0, 19147.0, 26795.0, 25785.0, 34638.0, 30925.0, 20686.0, 31555.0, 27314.0, 28338.0, 25952.0, 25999.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [20525.0, 21340.0, 28584.0, 31522.0, 59294.0, 33723.0, 28054.0, 28300.0, 32090.0, 23016.0, 43754.0, 23125.0], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [22432.0, 22917.0, 30854.0, 24349.0, 27281.0, 40668.0, 26642.0, 28813.0, 36775.0, 44089.0, 30151.0, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const vendaM2QuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [89513.0, 94390.0, 89818.0, 89009.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [89796.0, 88670.0, 81334.0, 81543.0], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [65128.0, 91348.0, 79555.0, 80289.0], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [70449.0, 124538.0, 88445.0, 89895.0], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [76204.0, 92298.0, 92231.0, 74240.0], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const vendaM2YearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [362730.0, 341344.0, 316320.0, 373327.0, 334972.0], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const vendaM2YearlyVar = ["-", "-5,9%", "-7,3%", "+18,0%", "-10,3%"];
  const lancMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [230.0, 662.0, 1021.0, 130.0, 852.0, 164.0, 56.0, 216.0, 248.0, 499.0, 382.0, 401.0], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [null, 550.0, 204.0, 300.0, 732.0, 40.0, 72.0, 441.0, null, 516.0, 368.0, 48.0], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [418.0, 175.0, 74.0, 407.0, 1029.0, 550.0, 108.0, 462.0, 1022.0, 644.0, null, 920.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [496.0, null, 30.0, 82.0, 607.0, 221.0, 94.0, 221.0, 233.0, 120.0, 249.0, null], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [105.0, null, 72.0, 90.0, 61.0, 456.0, 143.0, null, 294.0, 339.0, 180.0, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const lancQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [1913.0, 1146.0, 520.0, 1282.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [754.0, 1072.0, 513.0, 932.0], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [667.0, 1986.0, 1592.0, 1564.0], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [526.0, 910.0, 548.0, 369.0], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [177.0, 607.0, 437.0, 519.0], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const lancYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [4861.0, 3271.0, 5809.0, 2353.0, 1740.0], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const lancYearlyVar = ["-", "-32,7%", "+77,6%", "-59,5%", "-26,1%"];
  const lancProjMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [3.0, 4.0, 3.0, 2.0, 6.0, 2.0, 1.0, 3.0, 3.0, 8.0, 3.0, 2.0], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [null, 4.0, 2.0, 5.0, 2.0, 1.0, 1.0, 3.0, null, 3.0, 1.0, 1.0], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [2.0, 2.0, 2.0, 4.0, 5.0, 1.0, 1.0, 4.0, 2.0, 6.0, null, 3.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [0.0, null, 1.0, 2.0, 3.0, 3.0, 1.0, 1.0, 3.0, 1.0, 3.0, null], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [1.0, null, 1.0, 1.0, 1.0, 4.0, 3.0, null, 5.0, 1.0, 2.0, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const lancProjQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [10.0, 10.0, 7.0, 13.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [6.0, 8.0, 4.0, 5.0], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [6.0, 10.0, 7.0, 9.0], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [1.0, 8.0, 5.0, 4.0], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [2.0, 6.0, 8.0, 3.0], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const lancProjYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [40.0, 23.0, 32.0, 18.0, 19.0], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const lancProjYearlyVar = ["-", "-32,7%", "+77,6%", "-59,5%", "-26,1%"];
  const precosOfertaMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [10653.99, 10225.1, 9777.49, 9978.39, 10151.1, 10278.28, 10272.69, 10767.22, 10748.44, 11690.89, 11467.53, 11387.28], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [11565.08, 11689.47, 11703.49, 12085.85, 11909.77, 12202.24, 12705.77, 12808.19, 12832.52, 13096.8, 12716.95, 13085.96], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [12888.35, 12736.58, 13001.12, 13027.63, 12525.64, 12963.9, 12738.99, 13660.92, 12628.09, 12906.53, 12964.07, 12699.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [12466.25, 12533.79, 12656.19, 12730.81, 12684.01, 13510.6, 13668.6, 13665.8, 13733.35, 13747.78, 13991.32, 13890.92], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [14098.31, 14149.45, 14215.4, 14530.82, 14846.53, 14941.14, 15268.11, 15489.37, 15724.96, 15330.71, 15611.48, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const precosOfertaQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [10203.55, 10144.24, 10605.91, 11508.82], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [11654.19, 12063.56, 12782.37, 12962.9], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [12874.3, 12829.7, 13005.88, 12854.62], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [12550.25, 12963.38, 13689.09, 13879.14], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [14153.34, 14775.13, 15495.17, 15466.96], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const precosOfertaYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [10676.4, 12347.85, 12892.17, 13236.76, 14929.81], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const precosOfertaYearlyVar = ["-", "+15,7%", "+4,4%", "+2,7%", "+12,8%"];
  const precosVendaMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [8903.12, 8455.14, 8566.54, 9342.42, 9805.78, 9353.8, 8745.32, 10025.74, 10270.28, 9664.48, 9456.05, 9161.32], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [9407.76, 8577.41, 9606.06, 10149.81, 9730.34, 10051.57, 8257.61, 10573.48, 10032.95, 9478.14, 9757.73, 9793.82], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [9340.64, 9595.4, 11315.16, 10801.85, 10929.12, 12017.97, 11201.39, 14003.52, 11444.01, 12129.04, 11262.98, 9840.28], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [10073.22, 10488.36, 10650.14, 11116.6, 8684.12, 11787.72, 10657.8, 9891.16, 10838.99, 10689.33, 13860.85, 10539.77], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [10555.3, 10870.21, 12965.37, 13191.24, 12369.73, 12887.42, 12319.68, 12582.47, 12909.5, 12142.82, 12463.88, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const precosVendaQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [8611.21, 9493.47, 9764.98, 9402.64], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [9185.28, 9972.15, 9793.99, 9675.39], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [10227.88, 11261.82, 12396.12, 11107.96], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [10433.05, 10140.21, 10478.23, 12194.49], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [11625.82, 12814.56, 12636.95, 12273.21], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const precosVendaYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [9320.69, 9651.81, 11295.16, 10770.21, 12375.25], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const precosVendaYearlyVar = ["-", "+3,6%", "+17,0%", "-4,6%", "+14,9%"];
  const vgvOfertasMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [3500.73, 3568.4, 3569.26, 3322.44, 4018.45, 4026.09, 3744.89, 4139.19, 4484.26, 5095.32, 5533.69, 5567.99], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [5207.74, 5733.19, 5418.41, 5780.06, 5813.84, 5667.33, 5548.85, 5775.9, 5582.27, 5863.83, 5723.19, 5394.97], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [5436.88, 5261.81, 5224.78, 5356.25, 6001.77, 6213.17, 6009.35, 6829.57, 6737.92, 7349.49, 7087.48, 7294.99], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [7368.8, 7161.28, 7054.25, 6950.73, 7031.26, 6958.75, 6707.65, 6761.44, 6695.24, 6635.42, 7185.25, 6834.04], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [6955.89, 6623.11, 6637.33, 7340.46, 7337.09, 7931.42, 7509.79, 6454.06, 7808.13, 8100.78, 7777.24, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const vgvOfertasQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [3546.13, 3788.99, 4122.78, 5399.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [5453.12, 5753.74, 5635.67, 5660.66], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [5307.83, 5857.06, 6525.61, 7243.99], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [7194.77, 6980.25, 6721.44, 6884.91], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [6738.78, 7536.32, 7257.33, 7939.01], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const vgvOfertasYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [4214.23, 5625.8, 6233.62, 6945.34, 7315.94], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const vgvOfertasYearlyVar = ["-", "+33,5%", "+10,8%", "+11,4%", "+5,3%"];
  const vgvVendasMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [197.21, 262.43, 311.17, 283.51, 293.5, 319.09, 221.13, 279.86, 376.09, 275.91, 228.28, 332.73], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [168.56, 285.44, 370.8, 313.86, 305.35, 265.02, 180.49, 378.88, 237.22, 260.33, 266.87, 261.76], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [179.22, 183.72, 303.19, 278.53, 378.56, 371.66, 231.72, 441.88, 312.58, 343.71, 292.3, 255.84], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [206.76, 223.82, 304.42, 350.41, 514.91, 397.52, 299.0, 279.92, 347.82, 246.03, 606.46, 243.73], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [236.78, 249.11, 400.03, 321.2, 337.45, 524.11, 328.22, 362.54, 474.75, 535.37, 375.8, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const vgvVendasQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [770.81, 896.09, 877.07, 836.92], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [824.8, 884.23, 796.59, 788.96], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [666.12, 1028.75, 986.17, 891.84], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [735.0, 1262.85, 926.74, 1096.22], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [885.93, 1182.76, 1165.52, 911.16], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const vgvVendasYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [3380.89, 3294.58, 3572.89, 4020.81, 4145.37], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const vgvVendasYearlyVar = ["-", "-2,6%", "+8,4%", "+12,5%", "+3,1%"];
  const vglMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [316.95, 334.24, 240.72, 147.33, 732.04, 134.08, 99.19, 397.16, 399.09, 1082.19, 618.59, 193.82], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [null, 405.65, 121.27, 469.21, 445.18, 6.51, 96.0, 267.36, null, 443.67, 79.28, 18.23], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [114.06, 46.21, 157.85, 392.32, 765.56, 576.31, 104.32, 961.62, 319.99, 838.42, null, 385.96], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [94.56, null, 87.38, 198.66, 336.85, 474.98, 106.0, 223.64, 204.25, 59.73, 735.03, null], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [263.25, null, 129.08, 131.95, 158.47, 486.64, 180.34, null, 1199.77, 254.3, 170.48, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const vglQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [891.91, 1013.45, 895.44, 1894.59], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [526.92, 920.9, 363.36, 541.18], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [318.12, 1734.19, 1385.92, 1224.37], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [181.93, 1010.49, 533.88, 794.77], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [392.33, 777.06, 1380.1, 424.78], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const vglYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [4695.39, 2352.36, 4662.61, 2521.07, 2974.27], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const vglYearlyVar = ["-", "-49,9%", "+98,2%", "-45,9%", "+18,0%"];
  const distratosMonthlyData = {"labels": ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"], "datasets": [{"label": "2021", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "borderColor": "#e74c3c", "backgroundColor": "rgba(231, 76, 60, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2022", "data": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 40.0, 34.0], "borderColor": "#f39c12", "backgroundColor": "rgba(243, 156, 18, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2023", "data": [34.0, 34.0, 34.0, 34.0, 31.0, 15.0, 54.0, 53.0, 43.0, 29.0, 26.0, 9.0], "borderColor": "#9b59b6", "backgroundColor": "rgba(155, 89, 182, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2024", "data": [23.0, 27.0, 16.0, 13.0, 36.0, 45.0, 40.0, 27.0, 56.0, 72.0, 70.0, 41.0], "borderColor": "#3498db", "backgroundColor": "rgba(52, 152, 219, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle"}, {"label": "2025", "data": [29.0, 61.0, 229.0, 44.0, 21.0, 46.0, 43.0, 96.0, 35.0, 30.0, 23.0, null], "borderColor": "#27ae60", "backgroundColor": "rgba(39, 174, 96, 0.10)", "borderWidth": 2, "tension": 0.4, "pointRadius": 3, "pointHoverRadius": 5, "pointStyle": "circle", "borderDash": [6, 4]}]};
  const distratosQuarterlyData = {"labels": ["1T", "2T", "3T", "4T *"], "datasets": [{"label": "2021", "data": [0.0, 0.0, 0.0, 0.0], "backgroundColor": "rgba(231, 76, 60, 0.80)", "borderColor": "#e74c3c", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2022", "data": [0.0, 0.0, 0.0, 121.0], "backgroundColor": "rgba(243, 156, 18, 0.80)", "borderColor": "#f39c12", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2023", "data": [102.0, 80.0, 150.0, 64.0], "backgroundColor": "rgba(155, 89, 182, 0.80)", "borderColor": "#9b59b6", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2024", "data": [66.0, 94.0, 123.0, 183.0], "backgroundColor": "rgba(52, 152, 219, 0.80)", "borderColor": "#3498db", "borderWidth": 2, "pointStyle": "circle"}, {"label": "2025 *", "data": [319.0, 111.0, 174.0, 53.0], "backgroundColor": "rgba(39, 174, 96, 0.80)", "borderColor": "#27ae60", "borderWidth": 2, "pointStyle": "circle"}]};
  const distratosYearlyData = {"labels": ["2021", "2022", "2023", "2024", "2025 *"], "datasets": [{"label": "Valor", "data": [0.0, 121.0, 396.0, 466.0, 657.0], "backgroundColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderColor": ["#e74c3c", "#f39c12", "#9b59b6", "#3498db", "#27ae60"], "borderWidth": 1, "pointStyle": "circle"}]};
  const distratosYearlyVar = ["-", "-", "+227,3%", "+17,7%", "+41,0%"];


// ---------- Config base (legenda com bolinhas)
const legendCircle = {
  position: 'top',
  labels: {
    usePointStyle: true,
    pointStyle: 'circle'
  }
};

function drawYearlyChart(ctx, data, variations, labelFormatter) {
  // Calcular valores min/max
  const values = data.datasets[0].data.filter(v => v !== null && v !== undefined);
  const minValue = Math.min(...values);
  const maxValue = Math.max(...values);
  const range = maxValue - minValue;
  
  // Detectar tipo de dado baseado no contexto do gr√°fico - com verifica√ß√£o de seguran√ßa
  const chartId = ctx && ctx.canvas && ctx.canvas.id ? ctx.canvas.id : '';
  let yMin, yMax;
  
  if (chartId.includes('ivv')) {
    // IVV: Percentuais - SEMPRE m√∫ltiplos exatos de 1%
    yMin = Math.floor(minValue - 0.5); // Margem pequena para baixo
    yMax = Math.ceil(maxValue + 0.5);  // Margem pequena para cima
    
    // For√ßar m√∫ltiplos de 1% inteiro
    yMin = Math.max(0, Math.floor(yMin));
    yMax = Math.ceil(yMax);
    
    // Garantir range m√≠nimo para visualiza√ß√£o
    if (yMax - yMin < 3) {
      const center = (yMin + yMax) / 2;
      yMin = Math.floor(center - 1.5);
      yMax = Math.ceil(center + 1.5);
      yMin = Math.max(0, yMin); // N√£o pode ser negativo
    }
  } 
  else if (chartId.includes('precos') || chartId.includes('vgv')) {
    // Pre√ßos/VGV: M√∫ltiplos de 1000, sem decimais
    const buffer = range * 0.08;
    yMin = Math.max(0, Math.floor((minValue - buffer) / 1000) * 1000);
    yMax = Math.ceil((maxValue + buffer) / 1000) * 1000;
  }
  else {
    // Ofertas/Vendas/Lan√ßamentos: Algoritmo conservador
    const minBuffer = range * 0.10;
    const maxBuffer = range * 0.05;
    
    const rawYMin = Math.max(0, minValue - minBuffer);
    const rawYMax = maxValue + maxBuffer;
    
    // Arredondar para centenas ou milhares conforme magnitude
    const magnitude = Math.pow(10, Math.floor(Math.log10(maxValue)) - 1);
    yMin = Math.floor(rawYMin / magnitude) * magnitude;
    yMax = Math.ceil(rawYMax / magnitude) * magnitude;
  }

  return new Chart(ctx, {
    type: 'bar',
    data: data,
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: function(context) {
              const rawValue = context.parsed.y;
              const formattedValue = labelFormatter
                ? labelFormatter(rawValue)
                : rawValue.toLocaleString('pt-BR');

              const variation =
                variations && variations[context.dataIndex]
                  ? variations[context.dataIndex]
                  : '';

              return variation
                ? `${formattedValue} (${variation})`
                : formattedValue;
            }
          }
        }
      },
      scales: {
        y: {
          min: yMin,
          max: yMax,
          ticks: {
            // For√ßar ticks em n√∫meros inteiros para IVV
            stepSize: chartId.includes('ivv') ? 1 : undefined,
            callback: function(value) {
              // Formata√ß√£o espec√≠fica por tipo
              if (chartId.includes('precos') || chartId.includes('vgv')) {
                // Pre√ßos/VGV: sem casas decimais
                return labelFormatter && labelFormatter.toString().includes('R$')
                  ? 'R$ ' + value.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
                  : value.toLocaleString('pt-BR', { maximumFractionDigits: 0 });
              } else if (chartId.includes('ivv')) {
                // IVV: sempre mostrar como percentual inteiro
                return value.toFixed(0) + '%';
              } else {
                // Outros: usar labelFormatter normal ou formata√ß√£o padr√£o
                return labelFormatter
                  ? labelFormatter(value)
                  : value.toLocaleString('pt-BR');
              }
            }
          }
        }
      },
      animation: { duration: 2000, easing: 'easeInOutQuart' }
    }
  });
}
window.addEventListener('load', function() {

  // IVV
  if (typeof ivvMonthlyData !== 'undefined') {
    // Calcular limites para m√∫ltiplos de 1% 
    const values = ivvMonthlyData.datasets.flatMap(d => d.data.filter(v => v !== null));
    const minVal = Math.floor(Math.min(...values) - 0.5);
    const maxVal = Math.ceil(Math.max(...values) + 0.5);
    
    new Chart(document.getElementById('ivvMonthlyChart'), {
      type: 'line',
      data: ivvMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${fmtPercentBR(ctx.parsed.y)}`
            }
          }
        },
        scales: {
          y: {
            min: Math.max(0, minVal),
            max: maxVal,
            ticks: { 
              stepSize: 1,
              callback: (v) => v.toFixed(0) + '%'
            }
          }
        },
        animation: { duration: 2000, easing: 'easeInOutQuart' }
      }
    });
  }

  if (typeof ivvQuarterlyData !== 'undefined') {
    // Calcular limites para m√∫ltiplos de 1%
    const values = ivvQuarterlyData.datasets.flatMap(d => d.data.filter(v => v !== null));
    const minVal = Math.floor(Math.min(...values) - 0.5);
    const maxVal = Math.ceil(Math.max(...values) + 0.5);
    
    new Chart(document.getElementById('ivvQuarterlyChart'), {
      type: 'bar',
      data: ivvQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${fmtPercentBR(ctx.parsed.y)}`
            }
          }
        },
        scales: {
          y: {
            min: Math.max(0, minVal),
            max: maxVal,
            ticks: { 
              stepSize: 1,
              callback: (v) => v.toFixed(0) + '%'
            }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  if (typeof ivvYearlyData !== 'undefined') {
    // Calcular limites espec√≠ficos para IVV anual com m√∫ltiplos de 1%
    const values = ivvYearlyData.datasets[0].data.filter(v => v !== null && v !== undefined);
    const minVal = Math.floor(Math.min(...values) - 0.5);
    const maxVal = Math.ceil(Math.max(...values) + 0.5);
    
    new Chart(document.getElementById('ivvYearlyChart'), {
      type: 'bar',
      data: ivvYearlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              label: function(context) {
                const rawValue = context.parsed.y;
                const formattedValue = fmtPercentBR(rawValue);
                const variation = ivvYearlyVar && ivvYearlyVar[context.dataIndex] 
                  ? ivvYearlyVar[context.dataIndex] : '';
                return variation ? `${formattedValue} (${variation})` : formattedValue;
              }
            }
          }
        },
        scales: {
          y: {
            min: Math.max(0, minVal),
            max: maxVal,
            ticks: {
              stepSize: 1,
              callback: function(value) {
                return value.toFixed(0) + '%';
              }
            }
          }
        },
        animation: { duration: 2000, easing: 'easeInOutQuart' }
      }
    });
  }

  // Ofertas
  if (typeof ofertasMonthlyData !== 'undefined') {
    new Chart(document.getElementById('ofertasMonthlyChart'), {
      type: 'line',
      data: ofertasMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }

  if (typeof ofertasQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('ofertasQuarterlyChart'), {
      type: 'bar',
      data: ofertasQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  if (typeof ofertasYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('ofertasYearlyChart'),
      ofertasYearlyData,
      ofertasYearlyVar || [],
      (v) => v.toLocaleString('pt-BR')
    );
  }

  // Vendas
  if (typeof vendasMonthlyData !== 'undefined') {
    new Chart(document.getElementById('vendasMonthlyChart'), {
      type: 'line',
      data: vendasMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }

  if (typeof vendasQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('vendasQuarterlyChart'), {
      type: 'bar',
      data: vendasQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  if (typeof vendasYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('vendasYearlyChart'),
      vendasYearlyData,
      vendasYearlyVar || [],
      (v) => v.toLocaleString('pt-BR')
    );
  }

  // Oferta em m¬≤
  if (typeof ofertaM2MonthlyData !== 'undefined') {
    new Chart(document.getElementById('ofertaM2MonthlyChart'), {
      type: 'line',
      data: ofertaM2MonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }
  if (typeof ofertaM2QuarterlyData !== 'undefined') {
    new Chart(document.getElementById('ofertaM2QuarterlyChart'), {
      type: 'bar',
      data: ofertaM2QuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }
  if (typeof ofertaM2YearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('ofertaM2YearlyChart'),
      ofertaM2YearlyData,
      ofertaM2YearlyVar || [],
      (v) => v.toLocaleString('pt-BR')
    );
  }

  // Venda em m¬≤
  if (typeof vendaM2MonthlyData !== 'undefined') {
    new Chart(document.getElementById('vendaM2MonthlyChart'), {
      type: 'line',
      data: vendaM2MonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }
  if (typeof vendaM2QuarterlyData !== 'undefined') {
    new Chart(document.getElementById('vendaM2QuarterlyChart'), {
      type: 'bar',
      data: vendaM2QuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }
  if (typeof vendaM2YearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('vendaM2YearlyChart'),
      vendaM2YearlyData,
      vendaM2YearlyVar || [],
      (v) => v.toLocaleString('pt-BR')
    );
  }

  // Lan√ßamentos
  if (typeof lancMonthlyData !== 'undefined') {
    new Chart(document.getElementById('lancMonthlyChart'), {
      type: 'line',
      data: lancMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }

  if (typeof lancQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('lancQuarterlyChart'), {
      type: 'bar',
      data: lancQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  if (typeof lancYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('lancYearlyChart'),
      lancYearlyData,
      lancYearlyVar || [],
      (v) => v.toLocaleString('pt-BR')
    );
  }

  // Lan√ßamentos - Empreendimentos
  if (typeof lancProjMonthlyData !== 'undefined') {
    new Chart(document.getElementById('lancProjMonthlyChart'), {
      type: 'line',
      data: lancProjMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }
  if (typeof lancProjQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('lancProjQuarterlyChart'), {
      type: 'bar',
      data: lancProjQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR')}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => v.toLocaleString('pt-BR') }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }
  if (typeof lancProjYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('lancProjYearlyChart'),
      lancProjYearlyData,
      lancProjYearlyVar || [],
      (v) => v.toLocaleString('pt-BR')
    );
  }

  // Pre√ßos - Oferta
  if (typeof precosOfertaMonthlyData !== 'undefined') {
    new Chart(document.getElementById('precosOfertaMonthlyChart'), {
      type: 'line',
      data: precosOfertaMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }

  if (typeof precosOfertaQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('precosOfertaQuarterlyChart'), {
      type: 'bar',
      data: precosOfertaQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  if (typeof precosOfertaYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('precosOfertaYearlyChart'),
      precosOfertaYearlyData,
      precosOfertaYearlyVar || [],
      (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
    );
  }

  // Pre√ßos - Venda
  if (typeof precosVendaMonthlyData !== 'undefined') {
    new Chart(document.getElementById('precosVendaMonthlyChart'), {
      type: 'line',
      data: precosVendaMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }

  if (typeof precosVendaQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('precosVendaQuarterlyChart'), {
      type: 'bar',
      data: precosVendaQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: { callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  // >>> BLOCO ANUAL (ESTAVA FALTANDO) <<<
  if (typeof precosVendaYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('precosVendaYearlyChart'),
      precosVendaYearlyData,
      precosVendaYearlyVar || [],
      (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
    );
  }

  // VGV OFERTAS
  if (typeof vgvOfertasMonthlyData !== 'undefined') {
    new Chart(document.getElementById('vgvOfertasMonthlyChart'), {
      type: 'line',
      data: vgvOfertasMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}M`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
            }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }

  if (typeof vgvOfertasQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('vgvOfertasQuarterlyChart'), {
      type: 'bar',
      data: vgvOfertasQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}M`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
            }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  if (typeof vgvOfertasYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('vgvOfertasYearlyChart'),
      vgvOfertasYearlyData,
      vgvOfertasYearlyVar || [],
      (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
    );
  }

  // VGV VENDAS
  if (typeof vgvVendasMonthlyData !== 'undefined') {
    new Chart(document.getElementById('vgvVendasMonthlyChart'), {
      type: 'line',
      data: vgvVendasMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}M`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
            }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }

  if (typeof vgvVendasQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('vgvVendasQuarterlyChart'), {
      type: 'bar',
      data: vgvVendasQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}M`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
            }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }

  if (typeof vgvVendasYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('vgvVendasYearlyChart'),
      vgvVendasYearlyData,
      vgvVendasYearlyVar || [],
      (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
    );
  }

  // VGL (Valor Geral de Lan√ßamentos)
  if (typeof vglMonthlyData !== 'undefined') {
    new Chart(document.getElementById('vglMonthlyChart'), {
      type: 'line',
      data: vglMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}M`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
            }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }
  if (typeof vglQuarterlyData !== 'undefined') {
    new Chart(document.getElementById('vglQuarterlyChart'), {
      type: 'bar',
      data: vglQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: R$ ${ctx.parsed.y.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}M`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
            }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }
  if (typeof vglYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('vglYearlyChart'),
      vglYearlyData,
      vglYearlyVar || [],
      (v) => 'R$ ' + v.toLocaleString('pt-BR', { maximumFractionDigits: 0 }) + 'M'
    );
  }

  // Distratos
  if (typeof distratosMonthlyData !== 'undefined') {
    new Chart(document.getElementById('distratosMonthlyChart'), {
      type: 'line',
      data: distratosMonthlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            mode: 'index',
            intersect: false,
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y.toLocaleString('pt-BR', { maximumFractionDigits: 0 })}`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (v) => v.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
            }
          }
        },
        animation: { duration: 2000 }
      }
    });
  }
  if (typeof distratosQuarterlyData !== 'undefined') {
    // Configura√ß√£o espec√≠fica para distratos trimestrais - valores baixos (dezenas/centenas)
    new Chart(document.getElementById('distratosQuarterlyChart'), {
      type: 'bar',
      data: distratosQuarterlyData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: legendCircle,
          tooltip: {
            callbacks: {
              label: (ctx) => `${ctx.dataset.label}: ${ctx.parsed.y} unidades`
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            max: 400, // For√ßa escala m√°xima apropriada para distratos
            ticks: {
              stepSize: 50,
              callback: (v) => v // Apenas o n√∫mero, sem "un."
            }
          }
        },
        animation: { duration: 1500 }
      }
    });
  }
  if (typeof distratosYearlyData !== 'undefined') {
    drawYearlyChart(
      document.getElementById('distratosYearlyChart'),
      distratosYearlyData,
      distratosYearlyVar || [],
      (v) => v.toLocaleString('pt-BR', { maximumFractionDigits: 0 })
    );
  }

}); // Fechamento da fun√ß√£o window.addEventListener

</script>

  <!-- Presentation Container for slides (Desktop only) -->
  <div id="presentationContainer"></div>

  <script>
    (function() {
      const btn = document.getElementById('presentationButton');
      const container = document.getElementById('presentationContainer');
      let slides = [];
      let current = 0;
      // Armazenar as posi√ß√µes originais para restaurar
      let originalInfo = [];
      function createSlides() {
        slides = [];
        originalInfo = [];
        container.innerHTML = '';
        
        // Detectar se√ß√£o ativa atual para come√ßar da view correta
        const currentActiveSection = document.querySelector('.section.active');
        
        // Primeiro slide: cabe√ßalho + cards de resumo. Clonamos ambos para n√£o remover do DOM original.
        const header = document.querySelector('.header');
        const summary = document.querySelector('.summary-card');
        if (header || summary) {
          const slide0 = document.createElement('div');
          slide0.classList.add('slide');
          let combinedHTML = '';
          if (header) combinedHTML += header.outerHTML;
          if (summary) combinedHTML += summary.outerHTML;
          slide0.innerHTML = combinedHTML;
          slides.push({wrapper: slide0, element: null, sectionId: 'resumo'});
        }
        // Slides para cada gr√°fico e tabelas: mover o elemento real
        document.querySelectorAll('.chart-container').forEach(el => {
          const slide = document.createElement('div');
          slide.classList.add('slide');
          
          // Detectar de qual se√ß√£o este container faz parte
          const parentSection = el.closest('.section');
          const sectionId = parentSection ? parentSection.id : 'unknown';
          
          slides.push({wrapper: slide, element: el, sectionId: sectionId});
        });
        
        // Encontrar √≠ndice para come√ßar baseado na se√ß√£o ativa
        if (currentActiveSection) {
          const currentSectionId = currentActiveSection.id;
          for (let i = 0; i < slides.length; i++) {
            if (slides[i].sectionId === currentSectionId) {
              current = i; // Definir onde come√ßar
              break;
            }
          }
        } else {
          current = 0; // Come√ßar do in√≠cio se n√£o detectar se√ß√£o
        }
      }
      function attachSlides() {
        // Adicionar slides ao container, movendo os elementos reais
        slides.forEach((s) => {
          const {wrapper, element} = s;
          // se houver elemento associado, mover da p√°gina para o wrapper
          if (element) {
            originalInfo.push({
              element: element,
              parent: element.parentNode,
              nextSibling: element.nextSibling
            });
            wrapper.appendChild(element);
          }
          container.appendChild(wrapper);
        });
        // Ap√≥s anexar, ativar tooltips nativas no √∫ltimo ponto e mant√™-las vis√≠veis
        slides.forEach(({element}) => {
          if (element && element.classList.contains('chart-container')) {
            const canvas = element.querySelector('canvas');
            if (canvas) {
              try {
                let chart = null;
                if (Chart.getChart) {
                  chart = Chart.getChart(canvas) || Chart.getChart(canvas.id);
                }
                
                if (chart && chart.data && chart.data.labels && chart.data.labels.length > 0) {
                  const lastIndex = chart.data.labels.length - 1;
                  
                  // Fun√ß√£o para ativar tooltip nativa no √∫ltimo ponto permanentemente
                  const activateNativeTooltip = () => {
                    try {
                      // Configurar elementos ativos baseado no tipo de gr√°fico
                      let activeElements = [];
                      
                      if (chart.config && chart.config.type === 'line') {
                        // Para gr√°ficos de linha: ativar todos os datasets no √∫ltimo √≠ndice
                        activeElements = chart.data.datasets.map((ds, i) => ({ 
                          datasetIndex: i, 
                          index: lastIndex 
                        }));
                        
                        // Garantir modo de intera√ß√£o adequado
                        if (!chart.options.interaction) {
                          chart.options.interaction = {};
                        }
                        chart.options.interaction.mode = 'index';
                        chart.options.interaction.intersect = false;
                      } else {
                        // Para gr√°ficos de barras: ativar apenas o √∫ltimo dataset no √∫ltimo √≠ndice
                        const lastDatasetIndex = chart.data.datasets.length - 1;
                        activeElements = [{ 
                          datasetIndex: lastDatasetIndex, 
                          index: lastIndex 
                        }];
                      }
                      
                      // Ativar elementos e for√ßar tooltip a aparecer
                      if (chart.setActiveElements && activeElements.length > 0) {
                        chart.setActiveElements(activeElements);
                        chart.update('none'); // Atualiza sem anima√ß√£o
                        
                        // For√ßar tooltip a permanecer vis√≠vel
                        const originalTooltipPosition = chart.tooltip.getActiveElements();
                        
                        // Override do m√©todo de limpeza de tooltip para mant√™-la ativa
                        const originalSetActiveElements = chart.setActiveElements.bind(chart);
                        chart.setActiveElements = function(elements) {
                          // Se tentarem limpar, manter o √∫ltimo ponto ativo
                          if (!elements || elements.length === 0) {
                            elements = activeElements;
                          }
                          return originalSetActiveElements(elements);
                        };
                        
                        // Simular evento de mouse no √∫ltimo ponto para garantir que tooltip apare√ßa
                        setTimeout(() => {
                          try {
                            const meta = chart.getDatasetMeta(0);
                            if (meta && meta.data && meta.data[lastIndex]) {
                              const point = meta.data[lastIndex];
                              const rect = canvas.getBoundingClientRect();
                              const position = point.getCenterPoint();
                              
                              // Criar evento sint√©tico
                              const syntheticEvent = {
                                type: 'mousemove',
                                x: position.x,
                                y: position.y,
                                native: {
                                  clientX: rect.left + position.x,
                                  clientY: rect.top + position.y
                                }
                              };
                              
                              // Ativar tooltip
                              chart._handleEvent(syntheticEvent, true);
                            }
                          } catch (e) {
                            console.log('Fallback: usando setActiveElements');
                            chart.setActiveElements(activeElements);
                            chart.update('none');
                          }
                        }, 100);
                      }
                      
                    } catch (innerErr) {
                      console.error('Erro ao ativar tooltip nativa:', innerErr);
                    }
                  };
                  
                  // Ativar tooltip ap√≥s anima√ß√£o do gr√°fico
                  setTimeout(activateNativeTooltip, 2800);
                  
                  // Reativar periodicamente para garantir que permanece vis√≠vel
                  const keepActive = setInterval(() => {
                    if (element.closest('.slide.active')) {
                      activateNativeTooltip();
                    }
                  }, 5000);
                  
                  // Limpar interval quando slide n√£o estiver ativo
                  element.setAttribute('data-interval-id', keepActive);
                }
              } catch (err) {
                console.error('Erro ao configurar tooltip nativa:', err);
              }
            }
          }
        });
      }
      function detachSlides() {
        // Limpar intervals de tooltips ativas
        document.querySelectorAll('.chart-container[data-interval-id]').forEach(container => {
          const intervalId = container.getAttribute('data-interval-id');
          if (intervalId) {
            clearInterval(parseInt(intervalId));
            container.removeAttribute('data-interval-id');
          }
        });
        
        // Restaurar comportamento original dos gr√°ficos
        document.querySelectorAll('.chart-container canvas').forEach(canvas => {
          try {
            const chart = Chart.getChart(canvas);
            if (chart && chart.setActiveElements) {
              // Limpar elementos ativos
              chart.setActiveElements([]);
              chart.update('none');
            }
          } catch (e) {
            // Ignorar erros na limpeza
          }
        });
        
        // Mover os elementos de volta para seus locais originais
        originalInfo.forEach(info => {
          const {element, parent, nextSibling} = info;
          if (parent) {
            if (nextSibling && parent.contains(nextSibling)) {
              parent.insertBefore(element, nextSibling);
            } else {
              parent.appendChild(element);
            }
          }
        });
        originalInfo = [];
      }
      function showSlide(index) {
        slides.forEach((s, i) => {
          if (i === index) {
            s.wrapper.classList.add('active');
          } else {
            s.wrapper.classList.remove('active');
          }
        });
      }
      function startPresentation() {
        // BLOQUEAR APRESENTA√á√ÉO EM MOBILE
        if (window.innerWidth <= 768) {
          console.log('Apresenta√ß√£o desabilitada em dispositivos m√≥veis');
          return;
        }
        
        if (container.style.display === 'block') {
          // finalizar
          container.style.display = 'none';
          document.body.style.overflow = '';
          // sair de tela cheia, se ativo
          if (document.fullscreenElement) {
            const exitFull = document.exitFullscreen || document.webkitExitFullscreen || document.mozCancelFullScreen || document.msExitFullscreen;
            if (exitFull) exitFull.call(document);
          }
          if (btn) btn.textContent = 'Iniciar Apresenta√ß√£o';
          // remover slides e restaurar elementos
          detachSlides();
        } else {
          createSlides();
          attachSlides();
          container.style.display = 'block';
          document.body.style.overflow = 'hidden';
          // solicitar tela cheia, se suportado
          if (document.fullscreenEnabled) {
            const reqFull = container.requestFullscreen || container.webkitRequestFullscreen || container.mozRequestFullScreen || container.msRequestFullscreen;
            if (reqFull) reqFull.call(container);
          }
          // current j√° foi definido em createSlides()
          showSlide(current);
          if (btn) btn.textContent = 'Finalizar Apresenta√ß√£o';
        }
      }
      if (btn) {
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          startPresentation();
        });
      }
      
      // Apresenta√ß√£o desabilitada em mobile - eventos touch removidos
      
      // Monitorar sa√≠da do fullscreen para finalizar apresenta√ß√£o automaticamente
      document.addEventListener('fullscreenchange', () => {
        if (container.style.display === 'block' && !document.fullscreenElement) {
          // Usu√°rio saiu do fullscreen (provavelmente via ESC)
          // Finalizar apresenta√ß√£o automaticamente ap√≥s delay
          setTimeout(() => startPresentation(), 100);
        }
      });
      
      // Compatibilidade cross-browser para fullscreenchange
      document.addEventListener('webkitfullscreenchange', () => {
        if (container.style.display === 'block' && !document.webkitFullscreenElement) {
          setTimeout(() => startPresentation(), 100);
        }
      });
      
      document.addEventListener('mozfullscreenchange', () => {
        if (container.style.display === 'block' && !document.mozFullScreenElement) {
          setTimeout(() => startPresentation(), 100);
        }
      });

      // Navega√ß√£o via teclado
      document.addEventListener('keydown', (e) => {
        if (container.style.display === 'block') {
          if (e.key === 'ArrowRight' || e.key === 'PageDown') {
            if (current < slides.length - 1) {
              current += 1;
              showSlide(current);
            }
            e.preventDefault();
          } else if (e.key === 'ArrowLeft' || e.key === 'PageUp') {
            if (current > 0) {
              current -= 1;
              showSlide(current);
            }
            e.preventDefault();
          } else if (e.key === 'Escape') {
            // Se n√£o estiver em fullscreen, finalizar diretamente
            if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement) {
              startPresentation();
            }
            // Se estiver em fullscreen, o evento fullscreenchange cuidar√° da finaliza√ß√£o
          }
        }
      });
    })();
  </script>

  <!-- üé® COLORA√á√ÉO CONDICIONAL DOS DESTAQUES DOS GR√ÅFICOS MENSAIS -->
  <script>
    function colorizeInsights() {
      console.log('üé® Aplicando colora√ß√£o condicional nos destaques...');
      
      // Procurar todas as se√ß√µes de insights dos gr√°ficos mensais
      const insightSections = document.querySelectorAll('.insights ul li');
      let coloredCount = 0;
      
      insightSections.forEach(item => {
        const text = item.textContent;
        
        // Melhor detec√ß√£o de valores positivos e negativos
        // Procurar por padr√µes como: "-12,4%", "7,6%", "+8,8%", "-R$ 123M"
        const negativePattern = /-\s*(\d+[,.]?\d*%?|\d+[,.]?\d*[MK]?|R\$\s*\d+[,.]?\d*[MK]?)/;
        const explicitPositivePattern = /\+\s*(\d+[,.]?\d*%?|\d+[,.]?\d*[MK]?|R\$\s*\d+[,.]?\d*[MK]?)/;
        
        // Para valores sem sinal expl√≠cito, considerar contexto
        // Se cont√©m "MoM" ou "YoY" e n√£o tem sinal negativo, verificar se √© positivo
        const hasVariationContext = /\b(MoM|YoY|Varia√ß√£o)\b/i.test(text);
        const percentPattern = /(\d+[,.]?\d*%)/;
        
        let hasNegative = negativePattern.test(text);
        let hasExplicitPositive = explicitPositivePattern.test(text);
        
        // Para varia√ß√µes sem sinal expl√≠cito, assumir positivo se n√£o for negativo
        let hasImplicitPositive = false;
        if (hasVariationContext && !hasNegative && !hasExplicitPositive && percentPattern.test(text)) {
          hasImplicitPositive = true;
        }
        
        if (hasNegative || hasExplicitPositive || hasImplicitPositive) {
          // Aplicar APENAS COR - sem qualquer formata√ß√£o adicional
          if ((hasExplicitPositive || hasImplicitPositive) && !hasNegative) {
            item.style.color = '#27ae60'; // Verde para positivo
            coloredCount++;
          } else if (hasNegative) {
            item.style.color = '#e74c3c'; // Vermelho para negativo
            coloredCount++;
          }
          
          // REMOVIDO: Qualquer padding, margin, background, border, etc.
          // Aplicar APENAS a cor para n√£o interferir no layout
        }
      });
      
      console.log(`üé® Colora√ß√£o conclu√≠da: ${coloredCount} itens coloridos`);
    }
    
    // Aplicar coloriza√ß√£o ap√≥s carregamento da p√°gina
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', colorizeInsights);
    } else {
      colorizeInsights();
    }
    
    // Tamb√©m aplicar quando trocar de se√ß√£o (caso lazy loading)
    window.addEventListener('load', () => {
      setTimeout(colorizeInsights, 500);
    });
    
    console.log('üé® Sistema de coloriza√ß√£o de insights ativado!');
  </script>

</body>
</html>
